/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(e){var t={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},n=!1;e(window).bind("load.jcarousel",function(){n=!0}),e.jcarousel=function(r,s){this.options=e.extend({},t,s||{}),this.autoStopped=this.locked=!1,this.buttonPrevState=this.buttonNextState=this.buttonPrev=this.buttonNext=this.list=this.clip=this.container=null;if(!s||s.rtl===undefined)this.options.rtl=(e(r).attr("dir")||e("html").attr("dir")||"").toLowerCase()=="rtl";this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left";for(var o="",u=r.className.split(" "),a=0;a<u.length;a++)if(u[a].indexOf("jcarousel-skin")!=-1){e(r).removeClass(u[a]),o=u[a];break}r.nodeName.toUpperCase()=="UL"||r.nodeName.toUpperCase()=="OL"?(this.list=e(r),this.container=this.list.parent(),this.container.hasClass("jcarousel-clip")?(this.container.parent().hasClass("jcarousel-container")||(this.container=this.container.wrap("<div></div>")),this.container=this.container.parent()):this.container.hasClass("jcarousel-container")||(this.container=this.list.wrap("<div></div>").parent())):(this.container=e(r),this.list=this.container.find("ul,ol").eq(0)),o!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1&&this.container.wrap('<div class=" '+o+'"></div>'),this.clip=this.list.parent();if(!this.clip.length||!this.clip.hasClass("jcarousel-clip"))this.clip=this.list.wrap("<div></div>").parent();this.buttonNext=e(".jcarousel-next",this.container),this.buttonNext.size()===0&&this.options.buttonNextHTML!==null&&(this.buttonNext=this.clip.after(this.options.buttonNextHTML).next()),this.buttonNext.addClass(this.className("jcarousel-next")),this.buttonPrev=e(".jcarousel-prev",this.container),this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null&&(this.buttonPrev=this.clip.after(this.options.buttonPrevHTML).next()),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.clip.addClass(this.className("jcarousel-clip")).css({overflow:"hidden",position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"}),!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var f=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null;o=this.list.children("li");var l=this;if(o.size()>0){var c=0,h=this.options.offset;o.each(function(){l.format(this,h++),c+=l.dimension(this,f)}),this.list.css(this.wh,c+100+"px");if(!s||s.size===undefined)this.options.size=o.size()}this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){l.next()},this.funcPrev=function(){l.prev()},this.funcResize=function(){l.reload()},this.options.initCallback!==null&&this.options.initCallback(this,"init"),!n&&e.browser.safari?(this.buttons(!1,!1),e(window).bind("load.jcarousel",function(){l.setup()})):this.setup()};var r=e.jcarousel;r.fn=r.prototype={jcarousel:"0.2.7"},r.fn.extend=r.extend=e.extend,r.fn.extend({setup:function(){this.prevLast=this.prevFirst=this.last=this.first=null,this.animating=!1,this.tail=this.timer=null,this.inTail=!1;if(!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var t=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null,this.animate(t,!1),e(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),this.options.initCallback!==null&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){this.tail!==null&&this.inTail&&this.list.css(this.lt,r.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,this.options.reloadCallback!==null&&this.options.reloadCallback(this);if(this.options.visible!==null){var e=this,t=Math.ceil(this.clipping()/this.options.visible),n=0,i=0;this.list.children("li").each(function(r){n+=e.dimension(this,t),r+1<e.first&&(i=n)}),this.list.css(this.wh,n+"px"),this.list.css(this.lt,-i+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(e){return e!==undefined&&(this.options.size=e,this.locked||this.buttons()),this.options.size},has:function(e,t){if(t===undefined||!t)t=e;this.options.size!==null&&t>this.options.size&&(t=this.options.size);for(var n=e;n<=t;n++){var r=this.get(n);if(!r.length||r.hasClass("jcarousel-item-placeholder"))return!1}return!0},get:function(t){return e(".jcarousel-item-"+t,this.list)},add:function(t,n){var s=this.get(t),o=0,u=e(n);if(s.length===0){var a,f=r.intval(t);for(s=this.create(t);;){a=this.get(--f);if(f<=0||a.length){f<=0?this.list.prepend(s):a.after(s);break}}}else o=this.dimension(s);return u.get(0).nodeName.toUpperCase()=="LI"?(s.replaceWith(u),s=u):s.empty().append(n),this.format(s.removeClass(this.className("jcarousel-item-placeholder")),t),u=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,o=this.dimension(s,u)-o,t>0&&t<this.first&&this.list.css(this.lt,r.intval(this.list.css(this.lt))-o+"px"),this.list.css(this.wh,r.intval(this.list.css(this.wh))+o+"px"),s},remove:function(e){var t=this.get(e);if(!(!t.length||e>=this.first&&e<=this.last)){var n=this.dimension(t);e<this.first&&this.list.css(this.lt,r.intval(this.list.css(this.lt))+n+"px"),t.remove(),this.list.css(this.wh,r.intval(this.list.css(this.wh))-n+"px")}},next:function(){this.tail!==null&&!this.inTail?this.scrollTail(!1):this.scroll(this.options.wrap!="both"&&this.options.wrap!="last"||this.options.size===null||this.last!=this.options.size?this.first+this.options.scroll:1)},prev:function(){this.tail!==null&&this.inTail?this.scrollTail(!0):this.scroll(this.options.wrap!="both"&&this.options.wrap!="first"||this.options.size===null||this.first!=1?this.first-this.options.scroll:this.options.size)},scrollTail:function(e){if(!(this.locked||this.animating||!this.tail)){this.pauseAuto();var t=r.intval(this.list.css(this.lt));t=e?t+this.tail:t-this.tail,this.inTail=!e,this.prevFirst=this.first,this.prevLast=this.last,this.animate(t)}},scroll:function(e,t){!this.locked&&!this.animating&&(this.pauseAuto(),this.animate(this.pos(e),t))},pos:function(e,t){var n=r.intval(this.list.css(this.lt));if(this.locked||this.animating)return n;this.options.wrap!="circular"&&(e=e<1?1:this.options.size&&e>this.options.size?this.options.size:e);for(var i=this.first>e,s=this.options.wrap!="circular"&&this.first<=1?1:this.first,o=i?this.get(s):this.get(this.last),u=i?s:s-1,a=null,f=0,l=!1,c=0;i?--u>=e:++u<e;)a=this.get(u),l=!a.length,a.length===0&&(a=this.create(u).addClass(this.className("jcarousel-item-placeholder")),o[i?"before":"after"](a),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(u<=0||u>this.options.size)&&(o=this.get(this.index(u)),o.length&&(a=this.add(u,o.clone(!0))))),o=a,c=this.dimension(a),l&&(f+=c),this.first!==null&&(this.options.wrap=="circular"||u>=1&&(this.options.size===null||u<=this.options.size))&&(n=i?n+c:n-c);s=this.clipping();var p=[],d=0,v=0;o=this.get(e-1);for(u=e;++d;){a=this.get(u),l=!a.length,a.length===0&&(a=this.create(u).addClass(this.className("jcarousel-item-placeholder")),o.length===0?this.list.prepend(a):o[i?"before":"after"](a),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(u<=0||u>this.options.size)&&(o=this.get(this.index(u)),o.length&&(a=this.add(u,o.clone(!0))))),o=a,c=this.dimension(a);if(c===0)throw Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");this.options.wrap!="circular"&&this.options.size!==null&&u>this.options.size?p.push(a):l&&(f+=c),v+=c;if(v>=s)break;u++}for(a=0;a<p.length;a++)p[a].remove();f>0&&(this.list.css(this.wh,this.dimension(this.list)+f+"px"),i&&(n-=f,this.list.css(this.lt,r.intval(this.list.css(this.lt))-f+"px"))),f=e+d-1,this.options.wrap!="circular"&&this.options.size&&f>this.options.size&&(f=this.options.size);if(u>f){d=0,u=f;for(v=0;++d;){a=this.get(u--);if(!a.length)break;v+=this.dimension(a);if(v>=s)break}}u=f-d+1,this.options.wrap!="circular"&&u<1&&(u=1),this.inTail&&i&&(n+=this.tail,this.inTail=!1),this.tail=null,this.options.wrap!="circular"&&f==this.options.size&&f-d+1>=1&&(i=r.margin(this.get(f),this.options.vertical?"marginBottom":"marginRight"),v-i>s&&(this.tail=v-s-i)),t&&e===this.options.size&&this.tail&&(n-=this.tail,this.inTail=!0);for(;e-->u;)n+=this.dimension(this.get(e));return this.prevFirst=this.first,this.prevLast=this.last,this.first=u,this.last=f,n},animate:function(e,t){if(!this.locked&&!this.animating){this.animating=!0;var n=this,r=function(){n.animating=!1,e===0&&n.list.css(n.lt,0),!n.autoStopped&&(n.options.wrap=="circular"||n.options.wrap=="both"||n.options.wrap=="last"||n.options.size===null||n.last<n.options.size||n.last==n.options.size&&n.tail!==null&&!n.inTail)&&n.startAuto(),n.buttons(),n.notify("onAfterAnimation");if(n.options.wrap=="circular"&&n.options.size!==null)for(var t=n.prevFirst;t<=n.prevLast;t++)t!==null&&!(t>=n.first&&t<=n.last)&&(t<1||t>n.options.size)&&n.remove(t)};this.notify("onBeforeAnimation"),!this.options.animation||t===!1?(this.list.css(this.lt,e+"px"),r()):this.list.animate(this.options.vertical?{top:e}:this.options.rtl?{right:e}:{left:e},this.options.animation,this.options.easing,r)}},startAuto:function(e){e!==undefined&&(this.options.auto=e);if(this.options.auto===0)return this.stopAuto();if(this.timer===null){this.autoStopped=!1;var t=this;this.timer=window.setTimeout(function(){t.next()},this.options.auto*1e3)}},stopAuto:function(){this.pauseAuto(),this.autoStopped=!0},pauseAuto:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(e,t){e==null&&(e=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size===null||this.last<this.options.size),!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size&&(e=this.tail!==null&&!this.inTail)),t==null&&(t=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1),!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!==null&&this.first==1&&(t=this.tail!==null&&this.inTail));var n=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),e&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[e?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",e?!1:!0),this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=e&&this.buttonNext.each(function(){n.options.buttonNextCallback(n,this,e)}).data("jcarouselstate",e)):this.options.buttonNextCallback!==null&&this.buttonNextState!=e&&this.options.buttonNextCallback(n,null,e),this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),t&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[t?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",t?!1:!0),this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=t&&this.buttonPrev.each(function(){n.options.buttonPrevCallback(n,this,t)}).data("jcarouselstate",t)):this.options.buttonPrevCallback!==null&&this.buttonPrevState!=t&&this.options.buttonPrevCallback(n,null,t),this.buttonNextState=e,this.buttonPrevState=t},notify:function(e){var t=this.prevFirst===null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",e,t),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",e,t,this.first),this.callback("itemFirstOutCallback",e,t,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",e,t,this.last),this.callback("itemLastOutCallback",e,t,this.prevLast)),this.callback("itemVisibleInCallback",e,t,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",e,t,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(t,n,r,s,o,u,a){if(this.options[t]!=null&&(typeof this.options[t]=="object"||n=="onAfterAnimation")){var f=typeof this.options[t]=="object"?this.options[t][n]:this.options[t];if(e.isFunction(f)){var l=this;if(s===undefined)f(l,r,n);else if(o===undefined)this.get(s).each(function(){f(l,this,s,r,n)});else{t=function(e){l.get(e).each(function(){f(l,this,e,r,n)})};for(var c=s;c<=o;c++)c!==null&&!(c>=u&&c<=a)&&t(c)}}}},create:function(e){return this.format("<li></li>",e)},format:function(t,n){t=e(t);for(var r=t.get(0).className.split(" "),s=0;s<r.length;s++)r[s].indexOf("jcarousel-")!=-1&&t.removeClass(r[s]);return t.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+n)).css({"float":this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",n),t},className:function(e){return e+" "+e+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(t,n){var s=t.jquery!==undefined?t[0]:t,o=this.options.vertical?(s.offsetHeight||r.intval(this.options.itemFallbackDimension))+r.margin(s,"marginTop")+r.margin(s,"marginBottom"):(s.offsetWidth||r.intval(this.options.itemFallbackDimension))+r.margin(s,"marginLeft")+r.margin(s,"marginRight");return n==null||o==n?o:(o=this.options.vertical?n-r.margin(s,"marginTop")-r.margin(s,"marginBottom"):n-r.margin(s,"marginLeft")-r.margin(s,"marginRight"),e(s).css(this.wh,o+"px"),this.dimension(s))},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-r.intval(this.clip.css("borderTopWidth"))-r.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-r.intval(this.clip.css("borderLeftWidth"))-r.intval(this.clip.css("borderRightWidth"))},index:function(e,t){return t==null&&(t=this.options.size),Math.round(((e-1)/t-Math.floor((e-1)/t))*t)+1}}),r.extend({defaults:function(n){return e.extend(t,n||{})},margin:function(t,n){if(!t)return 0;var s=t.jquery!==undefined?t[0]:t;if(n=="marginRight"&&e.browser.safari){var o={display:"block","float":"none",width:"auto"},u,a;return e.swap(s,o,function(){u=s.offsetWidth}),o.marginRight=0,e.swap(s,o,function(){a=s.offsetWidth}),a-u}return r.intval(e.css(s,n))},intval:function(e){return e=parseInt(e,10),isNaN(e)?0:e}}),e.fn.jcarousel=function(t){if(typeof t=="string"){var n=e(this).data("jcarousel"),s=Array.prototype.slice.call(arguments,1);return n[t].apply(n,s)}return this.each(function(){e(this).data("jcarousel",new r(this,t))})}})(jQuery);