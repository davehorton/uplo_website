((function(){var a,b,c;c=function(a,b,c){var d,e,f,g,h,i;return d=$(document.createElement("div")).addClass("clear"),h=$(document.createElement("div")).addClass("line-separator left"),g=$(document.createElement("div")),g.attr("title",c),g.addClass("image-container thumb no-padding"),g.append(b),e=$(document.createElement("div")),e.addClass("info-panel left"),i=$(document.createElement("div")),i.addClass("info-line left"),f=$(document.createElement("div")),f.addClass("label text black bold font12"),f.text(c),i.append(f),e.append(i),a.addClass("upload-template container left"),a.append(g),a.append(e),a.append(d),a.append(h),a},b=function(a){var b;return b=$(document.createElement("div")),window.loadImage(a,function(d){return c(b,d,a.name),b.prependTo("#images-panel")},{maxWidth:155,maxHeight:155,canvas:!0}),b},a=function(a){return $("#delete-confirm-popup").modal(),$("#btn-ok").click(function(){return $.modal.close(),$("#mask").modal(),window.setTimeout("$('#mask').modal()",500),$.ajax({url:$(a).attr("data-url"),type:"GET",dataType:"json",success:function(a){return $("#images-panel")[0].innerHTML=a.items,$(".pagination-panel").each(function(b,c){return c.innerHTML=a.pagination}),alert("Delete successfully!"),$.modal.close()}})})},$(function(){return $("#fileupload").fileupload(),$("#fileupload").fileupload("option",{maxFileSize:5e6,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,previewMaxWidth:180,previewMaxHeight:180,displayNumber:page_size,add:function(a,c){return c.context=b(c.files[0]),$("#mask").modal(),c.submit()},done:function(a,b){return $(b.context).replaceWith(b.result.item),$(".pagination-panel").each(function(a,c){return c.innerHTML=b.result.pagination}),$(".pagination-panel").find(".pagination").length>0&&$("#images-panel").children().last().remove(),$.modal.close()}}),$(".button.save-grid-changes").click(function(){var a,b;return a=[],b=$("#images-panel .edit-template"),b.each(function(b,c){var d;return d=$(c),a.push({id:d.attr("data-id"),name:d.find("#image_name").val(),gallery_id:d.find("#image_gallery_id").val(),price:d.find("#image_price").val(),description:d.find("#image_description").val(),is_album_cover:d.find("#image_album_cover").val(),is_avatar:d.find("#user_avatar").val(),keyword:d.find("#image_key_words").val()})}),$("#mask").modal(),$.ajax({url:"/images/update_images",type:"POST",data:{images:$.toJSON(a),gallery_id:$("#gallery_selector_id").val()},dataType:"json",success:function(a){return $("#images-panel")[0].innerHTML=a.items,$(".pagination-panel").each(function(b,c){return c.innerHTML=a.pagination}),alert("Update successfully!"),$.modal.close()}})}),$("#gallery_selector_id").change(function(){return $.ajax({url:"edit_images",type:"GET",data:{gallery_id:$("#gallery_selector_id").val()},dataType:"json",success:function(a){return $("#images-panel")[0].innerHTML=a.items,$(".pagination-panel").each(function(b,c){return c.innerHTML=a.pagination}),$("#delete-gallery").attr("href",a.delete_url),$("#fileupload").attr("action",a.upload_url),$("#edit-gallery-popup").replaceWith(a.edit_popup)}})}),$("#images-panel").delegate(".button.delete-photo","click",function(b){return a(b.target)}),$("#edit-gallery").click(function(){return $("#edit-gallery-popup").modal()}),$("body").delegate(".popup .close","click",function(a){return $.modal.close()}),$("body").delegate("#btn-gallery-save","click",function(a){return $.ajax({url:$("#frm-edit-gallery").attr("action"),type:"POST",data:$("#frm-edit-gallery").serialize(),dataType:"json",success:function(a){return a.success?(alert("Your gallery has been updated!"),$.modal.close(),$("#edit-gallery-popup").replaceWith(a.edit_popup)):alert("Something went wrong!")}})})})})).call(this);