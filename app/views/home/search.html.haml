- content_for :head do
  = stylesheet_link_tag("scss/search.css")


#search-box-wrapper
  = render(:partial => "shared/search_box", :locals => {:action => "search"})
  
- if @users.count==0 and @galleries.count==0 and @images.count==0
  .empty-label There is no search result with "#{params[:query]}"
  
- if @users.count > 0
  .section.users
    .group-label
      .label Gallery owners:
      .more= link_to "(more results..)", :controller=>'users', :action=>'search', :query=>params[:query]
    .result-counter= "#{@users.total_entries} results for Gallery owners with \"#{params[:query]}\""
    .clear
    - @users.each do |user|
      .wrapper
        .preview
          =raw async_image_tag("member_normal.gif", :class => "gallery-cover-image")
        .info
          .name= user.fullname
          .email= user.email
          = link_to "(more galleries from #{user.fullname})", :controller=>'galleries', :action=>'show_public', :author => user.id
  
- if @galleries.count > 0
  .section.galleries
    .group-label
      .label Galleries: 
      .more= link_to "(more results..)", :controller=>'galleries', :action=>'search_public', :query=>params[:query]
    .result-counter= "#{@galleries.total_entries} results for Galleries with \"#{params[:query]}\""
    .clear
    - @galleries.each do |gallery|
      .wrapper{:id => "gallery-container-#{gallery.id}"}
        %a{:href => "#{url_for(:controller => 'images', :action => 'public_images', :gallery_id => gallery.id)}", :style => "float:left;"}
          .preview
            =raw async_image_tag(gallery_cover_image_url(gallery), :class => "gallery-cover-image")
        .info
          .name{:title => gallery.name}=raw gallery.name
          .description=raw gallery.description

- if @images.count >0
  .section.images
    .group-label
      .label{:style=>"clear:both;width:100%;"} Images
    .result-counter= "#{@images.total_entries} results for Images with \"#{params[:query]}\""
    .clear
    - @images.each do |img|
      .wrapper{:title=>"#{img.name}"}
        - url = url_for(:controller => "images", :action => "browse", :id => "#{img.id}")
        %a.gallery-image{:href => "#{url}" }
          %dl.entry
            %dt.preview
              = async_image_tag(img.data.url(:thumb), :class => "image-thumb")
            %dd.name= img.name.truncate(13)
            %dd.price= img.price.nil? ? '$0' : number_to_currency(img.price, {:precision => 2})

  %div{:style=>"clear:both;"}
  .section= render_pagination(@images, {:controller => "home", :action => params[:action]})
    
:erb
  <script>
  </script>
  
= javascript_include_tag "lib/blueimp/tmpl.min.js"
