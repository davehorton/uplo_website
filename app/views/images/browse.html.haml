= stylesheet_link_tag("slideshow.css")
= javascript_include_tag("jquery.jcarousel.min.js")
.slideshow-container
  .top-container
    .left-container.clearfix.left.round-box
      #image-viewer
        = image_tag @image.data.url
    = simple_form_for(:image, :id => @image, :action => :update, :method => 'put') do |f|
      .right-container.right
        .edit-area.round-box.clearfix
          = (@image.author ? @image.author.fullname : "")
          %br.clearfix
          %ul
            %li
              = I18n.t("slideshow.picture_name")
            %li
              = @image.name
            %li
              = I18n.t("slideshow.description")
            %li
              = @image.description
        
        .button-container.blue-gradient
          %ul
            %li
              %div
                = button_to "Comment"
            %li
              %div
                = button_to "Like"
            %li
              %div
                = f.submit "Order"
                
  .bottom-container.clearfix
    %br
    %div
      %ul#mycarousel.jcarousel-skin-tango
        - selected_image_position = 1
        - @images.each_with_index do |image, index|
          %li
            - url = url_for(:controller => "images", :action => "browse", :id => "#{image.id}")
            %a{:href => "#{url}"}
              - if image.id == @image.id 
                - selected_image_position = index 
                = image_tag(image.data.url(:thumb), :size => "70x70", :style => "border: solid 2px orange")
              - else
                = image_tag(image.data.url(:thumb), :size => "75x75")
:erb
  <script type="text/javascript">
  function mycarousel_initCallback(carousel)
  {
    // Disable autoscrolling if the user clicks the prev or next button.
    carousel.buttonNext.bind('click', function() {
        carousel.startAuto(0);
    });

    carousel.buttonPrev.bind('click', function() {
        carousel.startAuto(0);
    });

    // Pause autoscrolling if the user moves with the cursor over the clip.
    carousel.clip.hover(function() {
        carousel.stopAuto();
    }, function() {
        carousel.startAuto();
    });
  };

  jQuery(document).ready(function() {
    jQuery('#mycarousel').jcarousel({
        auto: 2,
        start: <%= selected_image_position %>,
        scroll: 3,
        initCallback: mycarousel_initCallback
    });
  });

  </script>
